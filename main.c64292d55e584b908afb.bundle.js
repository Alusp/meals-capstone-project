(()=>{"use strict";const e=e=>new class{constructor(t=e){this.component=document.createElement(t.component)}getComponent(){return delete e.component,Object.keys(e).forEach((t=>{this.component[t]=e[t]})),this.component}}(e).getComponent(),t=t=>e({...t}),n=t=>e({...t});const o=new class{constructor(){this.like_url="https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/apps/0TcGatzACGyS9TB2cu04/likes/",this.comment_url="https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/apps/0TcGatzACGyS9TB2cu04/comments/",this.meal_url="https://www.themealdb.com/api/json/v1/1/filter.php?c=Dessert",this.search_meal="https://www.themealdb.com/api/json/v1/1/lookup.php?i="}promisedData=(e=null,t=!1)=>{const n=e=>({method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(e)});return(async()=>{let o;try{let s=this.meal_url;if(t)"comment"===e.type?(s=this.comment_url,delete e.type,o=await(await fetch(s,e?n(e):[])).text()):"like"===e.type&&(s=this.like_url,delete e.type,o=await(await fetch(s,e?n(e):[])).text());else{if("string"==typeof e)if(e.includes("search_meal")){const t=e.split("=")[1];s=this.search_meal+t,e=null}else if(e.includes("commenting_meal")){const t=e.split("=")[1];s=`${this.comment_url}?item_id=${t}`,e=null}else e=null;else if("comment"===e.type){const t=e.item_id;s=`${this.comment_url}?item_id=${t}`}else s=this.like_url,e=null;o=await(await fetch(s,e?n(e):[])).json()}}catch(e){o=new Error("Oops ! Something went wrong ...").message}return o})()};get=async(e=null)=>await this.promisedData(e);post=async(e,t=!1)=>{let n;return n=t||""!==e.username&&""!==e.comment?await this.promisedData(e,t):new Error("Please fill the form, before submission ...").message,n}},s=async(e,t=!1)=>{const n=document.querySelector(".comment-heading .counter"),s=document.querySelector(".commentUnorderedList");try{const c=await o.get(`commenting_meal=${e}`);let a=0;c.forEach((e=>{s.append((e=>{const t=document.createElement("li");t.className="commentUsers";const{creation_date:n,username:o,comment:s}=e;return t.textContent=`${n} ${o} : ${s}`,t})(e)),t||(a=Number(n.textContent)),a+=1,n.textContent=a}))}catch(e){s.textContent="Comment Not Found !!"}},c=async e=>{const t=document.getElementById("overlay");t.classList.remove("disable");const n=await o.get(`search_meal=${e}`),[c]=n.meals;t.textContent="",t.innerHTML=`\n    <div class="modalWindow">\n    <div id="recipe"> \n      <button id="hide-recipe"> X</button>\n      <img src=${c.strMealThumb} class="ingredient-img">\n      <div class="foodname">\n        <h2>${c.strMeal}</h2>\n      </div>\n      <ul class="ingredients"></ul>\n      <div class="people-comment">\n        <h2 class="comment-heading">Comments( <span class="counter">0</span> )</h2>\n      </div>\n      <div class="commentlist">\n        <ul class="commentUnorderedList"></ul>\n      </div>\n      <div class="commenttext">\n        <h2>Add a comment</h2>\n      </div>\n      <form class="forms" id=${e}>\n        <input type="text" placeholder="Enter your name" id="comment-name" />\n        <textarea id="commentsms" name="message" rows="4" cols="50" placeholder="Your insights" required></textarea>\n        <button class="combutton" type="submit">Comment</button>\n      </form>\n    </div>\n  </div>\n  `;const a=document.getElementById("recipe");a.style.display="block";const l=document.querySelector(".ingredients"),i=document.getElementById("hide-recipe"),m=Object.keys(c).filter((e=>e.includes("strIngredient")&&""!==c[e]&&null!==c[e])),r=document.querySelector(".forms");s(e),r.addEventListener("submit",(e=>{e.preventDefault();const{id:t}=e.target;(async()=>{const e=document.querySelector(".commentUnorderedList"),n=document.querySelector("#comment-name").value,c=document.querySelector("#commentsms").value;await o.post({username:n,comment:c,item_id:t,type:"comment"}),e.textContent="",s(t,!0)})(),e.target.reset()})),m.forEach((e=>{const t=document.createElement("li");t.className="ingredient-list",t.textContent=c[e],l.appendChild(t)})),i.addEventListener("click",(()=>{a.style.display="none",t.classList.add("disable")}))},a=t({component:"ul",className:"meals-grid_wrapper"}),l=()=>((async()=>{const s=await o.get("getting_meal"),{meals:l}=s;t.textContent="";const i=await o.get({type:"like"});l.forEach((t=>{const s=(l={className:"meals-grid_wrapper-list",id:`meal-card-${t.idMeal}`},e({component:"li",...l}));var l;const m=n({component:"article",className:"meals-grid_wrapper-article"}),r=n({component:"div",className:"meals-grid_wrapper-article__img-wrapper"}),d=(t=>e({component:"img",...t}))({src:t.strMealThumb,className:"img",alt:"meals"});r.append(d);const p=(t=>e({component:"h2",...t}))({className:"meal-title",textContent:t.strMeal}),u=n({component:"div",className:"user_interaction"}),h=n({component:"div",className:"like-wrapper"}),y=n({component:"label",className:"checkbox-wrapper",for:`like-count-${t.idMeal}`}),g=n({component:"i",className:"fa-solid fa-heart icon"}),[f]=((e,t)=>e.filter((e=>e.item_id===t)))(i,t.idMeal),v=(t=>e({component:"p",...t}))({className:"counter",textContent:`(${f?f.likes:0})`}),w=(t=>e({component:"input",...t}))({type:"checkbox",className:"like-checkbox",id:`like-count-${t.idMeal}`,name:`like-count-${t.idMeal}`,onclick:e=>(async()=>{if(e.target.checked){await o.post({item_id:t.idMeal,type:"like"},!0);let e=Number(v.textContent.replace("(","").replace(")","").trim());e+=1,v.textContent=`(${e})`}})()});y.append(w,g),h.append(y,v);const _=(t=>e({component:"button",...t}))({className:"comment-btn",textContent:"comments",onclick:()=>c(t.idMeal)});u.append(h,_),m.append(r,p,u),s.append(m),a.append(s);document.querySelector(".meal-item__counter").textContent=a.children.length}))})(),a),i=()=>l(),m=document.querySelector(".nav-menu_ul"),r=document.querySelectorAll(".nav-menu_option");document.querySelector("#root").append(i()),m.addEventListener("click",(e=>{r.forEach((e=>e.classList.remove("active"))),e.target.classList.add("active");const t=e.target,n=document.querySelectorAll(".meals-grid_wrapper-list");"Most Liked"===t.textContent?n.forEach((e=>{"(0)"===e.querySelector(".counter").textContent&&e.classList.add("display-none")})):t.textContent.includes("Meals")&&n.forEach((e=>{"(0)"===e.querySelector(".counter").textContent&&e.classList.remove("display-none")}))}))})();